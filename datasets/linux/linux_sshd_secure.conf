# CIS Hardened sshd_config
# /etc/ssh/sshd_config

Protocol 2
Port 22
ListenAddress 0.0.0.0

# Authentication
PermitRootLogin no
MaxAuthTries 4
PermitEmptyPasswords no
PasswordAuthentication yes
PubkeyAuthentication yes
AuthenticationMethods publickey,password

# Logging
LogLevel INFO
SyslogFacility AUTH

# Session
LoginGraceTime 60
ClientAliveInterval 300
ClientAliveCountMax 3

# Security
X11Forwarding no
AllowTcpForwarding no
PermitUserEnvironment no
AllowAgentForwarding no

# Cryptography
Ciphers aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512,hmac-sha2-256
KexAlgorithms curve25519-sha256,diffie-hellman-group-exchange-sha256

# Banner
Banner /etc/issue.net

# Subsystems
Subsystem sftp /usr/lib/openssh/sftp-server
