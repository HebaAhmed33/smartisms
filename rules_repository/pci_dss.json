[
    {
        "rule_id": "PCI-1.1-001",
        "standard": "PCI-DSS",
        "control_id": "1.1",
        "platform": "firewall",
        "description": "Ensure firewall default deny rule is configured",
        "check_type": "regex",
        "expected_value": "(iptables.*-P.*DROP|policy\\s+drop|ufw\\s+default\\s+deny)",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Configure firewall to deny all inbound traffic by default",
        "remediation_command_example": "iptables -P INPUT DROP"
    },
    {
        "rule_id": "PCI-1.1-002",
        "standard": "PCI-DSS",
        "control_id": "1.1",
        "platform": "cisco",
        "description": "Ensure access control lists are configured on Cisco router",
        "check_type": "contains",
        "expected_value": "access-list",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Configure ACLs to control network traffic to/from cardholder data environment",
        "remediation_command_example": "access-list 101 deny ip any any"
    },
    {
        "rule_id": "PCI-2.1-001",
        "standard": "PCI-DSS",
        "control_id": "2.1",
        "platform": "cisco",
        "description": "Ensure default SNMP community strings are changed",
        "check_type": "not_contains",
        "expected_value": "snmp-server community public",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Change default SNMP community strings from public/private to a custom value",
        "remediation_command_example": "no snmp-server community public\nsnmp-server community <custom-string> RO"
    },
    {
        "rule_id": "PCI-2.2-001",
        "standard": "PCI-DSS",
        "control_id": "2.2",
        "platform": "cisco",
        "description": "Ensure password encryption service is enabled",
        "check_type": "contains",
        "expected_value": "service password-encryption",
        "severity": "High",
        "weight": 9,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Enable password encryption to protect all stored credentials",
        "remediation_command_example": "service password-encryption"
    },
    {
        "rule_id": "PCI-2.3-001",
        "standard": "PCI-DSS",
        "control_id": "2.3",
        "platform": "cisco",
        "description": "Ensure Telnet is not used for management access",
        "check_type": "not_contains",
        "expected_value": "transport input telnet",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Disable Telnet and use SSH for all administrative access",
        "remediation_command_example": "line vty 0 4\n transport input ssh"
    },
    {
        "rule_id": "PCI-4.1-001",
        "standard": "PCI-DSS",
        "control_id": "4.1",
        "platform": "nginx",
        "description": "Ensure TLS/SSL encryption is enabled for data in transit",
        "check_type": "contains",
        "expected_value": "ssl_certificate",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Configure SSL/TLS certificates to encrypt all cardholder data in transit",
        "remediation_command_example": "ssl_certificate /etc/nginx/ssl/server.crt;\nssl_certificate_key /etc/nginx/ssl/server.key;"
    },
    {
        "rule_id": "PCI-4.1-002",
        "standard": "PCI-DSS",
        "control_id": "4.1",
        "platform": "nginx",
        "description": "Ensure weak SSL protocols are disabled",
        "check_type": "contains",
        "expected_value": "ssl_protocols TLSv1.2",
        "severity": "High",
        "weight": 9,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Disable SSLv3, TLSv1.0, and TLSv1.1; enforce TLSv1.2 or higher",
        "remediation_command_example": "ssl_protocols TLSv1.2 TLSv1.3;"
    },
    {
        "rule_id": "PCI-4.1-003",
        "standard": "PCI-DSS",
        "control_id": "4.1",
        "platform": "apache",
        "description": "Ensure SSL engine is enabled on Apache",
        "check_type": "contains",
        "expected_value": "SSLEngine on",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Enable SSLEngine on VirtualHost to encrypt traffic",
        "remediation_command_example": "SSLEngine on"
    },
    {
        "rule_id": "PCI-4.1-004",
        "standard": "PCI-DSS",
        "control_id": "4.1",
        "platform": "apache",
        "description": "Ensure only strong SSL protocols are used",
        "check_type": "contains",
        "expected_value": "SSLProtocol",
        "severity": "High",
        "weight": 9,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Configure SSLProtocol to only allow TLSv1.2+",
        "remediation_command_example": "SSLProtocol -all +TLSv1.2 +TLSv1.3"
    },
    {
        "rule_id": "PCI-8.1-001",
        "standard": "PCI-DSS",
        "control_id": "8.1",
        "platform": "linux",
        "description": "Ensure unique user IDs are enforced (no root SSH)",
        "check_type": "contains",
        "expected_value": "PermitRootLogin no",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Disable root login to enforce individual accountability",
        "remediation_command_example": "PermitRootLogin no"
    },
    {
        "rule_id": "PCI-8.2-001",
        "standard": "PCI-DSS",
        "control_id": "8.2",
        "platform": "linux",
        "description": "Ensure password-based SSH authentication is disabled",
        "check_type": "contains",
        "expected_value": "PasswordAuthentication no",
        "severity": "Medium",
        "weight": 7,
        "impact": 2,
        "likelihood_base": 2,
        "remediation_text": "Use key-based authentication instead of passwords for SSH",
        "remediation_command_example": "PasswordAuthentication no"
    },
    {
        "rule_id": "PCI-8.5-001",
        "standard": "PCI-DSS",
        "control_id": "8.5",
        "platform": "cisco",
        "description": "Ensure local login authentication is enforced on VTY lines",
        "check_type": "contains",
        "expected_value": "login local",
        "severity": "High",
        "weight": 9,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Configure login local on VTY lines for user-level authentication",
        "remediation_command_example": "line vty 0 4\n login local"
    },
    {
        "rule_id": "PCI-10.1-001",
        "standard": "PCI-DSS",
        "control_id": "10.1",
        "platform": "cisco",
        "description": "Ensure logging is enabled on the device",
        "check_type": "contains",
        "expected_value": "logging buffered",
        "severity": "High",
        "weight": 8,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Enable logging to maintain audit trail for PCI compliance",
        "remediation_command_example": "logging buffered 16384 informational"
    },
    {
        "rule_id": "PCI-10.2-001",
        "standard": "PCI-DSS",
        "control_id": "10.2",
        "platform": "firewall",
        "description": "Ensure firewall logging of dropped packets is enabled",
        "check_type": "regex",
        "expected_value": "(iptables.*LOG|log-prefix|logging\\s+on)",
        "severity": "High",
        "weight": 8,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Enable logging on firewall rules for audit trail of denied connections",
        "remediation_command_example": "iptables -A INPUT -j LOG --log-prefix 'FW-DROP: '"
    },
    {
        "rule_id": "PCI-2.2-002",
        "standard": "PCI-DSS",
        "control_id": "2.2",
        "platform": "nginx",
        "description": "Ensure server version information is hidden",
        "check_type": "contains",
        "expected_value": "server_tokens off",
        "severity": "Medium",
        "weight": 5,
        "impact": 2,
        "likelihood_base": 1,
        "remediation_text": "Disable server_tokens to prevent version disclosure",
        "remediation_command_example": "server_tokens off;"
    },
    {
        "rule_id": "PCI-2.2-003",
        "standard": "PCI-DSS",
        "control_id": "2.2",
        "platform": "apache",
        "description": "Ensure Apache ServerTokens is set to Prod",
        "check_type": "contains",
        "expected_value": "ServerTokens Prod",
        "severity": "Medium",
        "weight": 5,
        "impact": 2,
        "likelihood_base": 1,
        "remediation_text": "Minimize HTTP header information exposure by setting ServerTokens Prod",
        "remediation_command_example": "ServerTokens Prod"
    },
    {
        "rule_id": "PCI-1.3-001",
        "standard": "PCI-DSS",
        "control_id": "1.3",
        "platform": "junos",
        "description": "Ensure stateful firewall filter exists on JunOS",
        "check_type": "contains",
        "expected_value": "firewall",
        "severity": "High",
        "weight": 9,
        "impact": 3,
        "likelihood_base": 2,
        "remediation_text": "Configure firewall filters on JunOS to segment the cardholder data environment",
        "remediation_command_example": "set firewall family inet filter PROTECT-CDE"
    },
    {
        "rule_id": "PCI-2.2-004",
        "standard": "PCI-DSS",
        "control_id": "2.2",
        "platform": "junos",
        "description": "Ensure Telnet is disabled on JunOS",
        "check_type": "not_contains",
        "expected_value": "set system services telnet",
        "severity": "High",
        "weight": 10,
        "impact": 3,
        "likelihood_base": 3,
        "remediation_text": "Disable Telnet service and use SSH exclusively",
        "remediation_command_example": "delete system services telnet"
    }
]