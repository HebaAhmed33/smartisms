[
    {
        "rule_id": "ISO-LINUX-001",
        "standard": "ISO27001",
        "control_id": "A.9.2.3",
        "title": "Management of privileged access — Disable root SSH",
        "description": "ISO 27001 A.9.2.3 requires management of privileged access rights.",
        "vendor": "linux",
        "category": "access_control",
        "severity": "high",
        "weight": 5,
        "condition": {
            "type": "key_value_match",
            "scope": "global",
            "key": "PermitRootLogin",
            "operator": "equals",
            "expected_value": "no"
        },
        "remediation_text": "Disable SSH root login per ISO 27001 A.9.2.3.",
        "remediation_command": "# In /etc/ssh/sshd_config:\nPermitRootLogin no",
        "cross_standard_refs": [
            "CIS-5.2.8",
            "PCI-DSS-8.1.1",
            "HIPAA-164.312(a)(1)"
        ]
    },
    {
        "rule_id": "ISO-LINUX-002",
        "standard": "ISO27001",
        "control_id": "A.10.1.1",
        "title": "Cryptographic policy — Strong SSH ciphers",
        "description": "ISO 27001 A.10.1.1 requires cryptographic controls. Strong ciphers must be configured.",
        "vendor": "linux",
        "category": "encryption",
        "severity": "high",
        "weight": 4,
        "condition": {
            "type": "key_value_match",
            "scope": "global",
            "key": "Ciphers",
            "operator": "exists",
            "expected_value": ""
        },
        "remediation_text": "Configure strong SSH ciphers per ISO 27001 A.10.1.1.",
        "remediation_command": "# In /etc/ssh/sshd_config:\nCiphers aes256-ctr,aes192-ctr,aes128-ctr",
        "cross_standard_refs": [
            "CIS-5.2.11",
            "PCI-DSS-4.1"
        ]
    },
    {
        "rule_id": "ISO-NGINX-001",
        "standard": "ISO27001",
        "control_id": "A.10.1.1",
        "title": "Cryptographic controls — TLS configuration",
        "description": "ISO 27001 A.10.1.1 requires encryption. TLS must be configured for web servers.",
        "vendor": "nginx",
        "category": "encryption",
        "severity": "high",
        "weight": 5,
        "condition": {
            "type": "key_value_match",
            "scope": "global",
            "key": "server::ssl_protocols",
            "operator": "exists",
            "expected_value": ""
        },
        "remediation_text": "Configure TLS per ISO 27001 A.10.1.1.",
        "remediation_command": "ssl_protocols TLSv1.2 TLSv1.3;",
        "cross_standard_refs": [
            "CIS-2.1.1",
            "PCI-DSS-4.1",
            "HIPAA-164.312(e)(1)"
        ]
    },
    {
        "rule_id": "PCI-LINUX-001",
        "standard": "PCI-DSS",
        "control_id": "PCI-8.1.1",
        "title": "Unique user IDs — Disable root SSH",
        "description": "PCI-DSS 8.1.1 requires unique user identification. Root SSH must be disabled.",
        "vendor": "linux",
        "category": "access_control",
        "severity": "high",
        "weight": 5,
        "condition": {
            "type": "key_value_match",
            "scope": "global",
            "key": "PermitRootLogin",
            "operator": "equals",
            "expected_value": "no"
        },
        "remediation_text": "Disable root SSH per PCI-DSS 8.1.1.",
        "remediation_command": "# In /etc/ssh/sshd_config:\nPermitRootLogin no",
        "cross_standard_refs": [
            "ISO27001-A.9.2.3",
            "CIS-5.2.8",
            "HIPAA-164.312(a)(1)"
        ]
    },
    {
        "rule_id": "PCI-NGINX-001",
        "standard": "PCI-DSS",
        "control_id": "PCI-4.1",
        "title": "Encrypt data in transit — TLS configured",
        "description": "PCI-DSS 4.1 requires strong cryptography for data in transit.",
        "vendor": "nginx",
        "category": "encryption",
        "severity": "high",
        "weight": 5,
        "condition": {
            "type": "key_value_match",
            "scope": "global",
            "key": "server::ssl_protocols",
            "operator": "exists",
            "expected_value": ""
        },
        "remediation_text": "Configure TLS per PCI-DSS 4.1.",
        "remediation_command": "ssl_protocols TLSv1.2 TLSv1.3;",
        "cross_standard_refs": [
            "ISO27001-A.10.1.1",
            "CIS-2.1.1"
        ]
    }
]